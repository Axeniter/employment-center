<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="EmploymentApp.Pages.EmployerPage"
             xmlns:models="clr-namespace:EmploymentApp.Models"
             Title="EmployerPage">
    
    <ScrollView>
        <VerticalStackLayout>
            <Grid HeightRequest="40"
                  BackgroundColor="#9dfca8">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Label Text="Вакансии"
                        Grid.Column="0"
                        BackgroundColor="Transparent"
                        TextColor="Black"
                        FontSize="16"
                        VerticalOptions="Center"
                        HorizontalOptions="Center"/>

                <Label Text="Coбытия"
                       Grid.Column="1"
                       BackgroundColor="Transparent"
                       TextColor="Black"
                       FontSize="16"
                       VerticalOptions="Center"
                       HorizontalOptions="Start"/>

                <Label Text="Чат"
                       Grid.Column="3"
                       BackgroundColor="Transparent"
                       TextColor="Black"
                       FontSize="16"
                       VerticalOptions="Center"
                       HorizontalOptions="End"/>

                <Label Text="Профиль"
                       Grid.Column="4"
                       BackgroundColor="Transparent"
                       TextColor="Black"
                       FontSize="16"
                       VerticalOptions="Center"
                       HorizontalOptions="Center"/>

            </Grid>

            <Grid RowDefinitions="*, Auto, Auto, Auto" 
                  ColumnDefinitions="Auto, *"
                  Padding="60,40,40,20" 
                  RowSpacing="30"
                  ColumnSpacing="40">

                <!-- Аватарка -->
                <Border Grid.Column="0"
                        Grid.Row="0"
                        StrokeShape="RoundRectangle 100"
                        StrokeThickness="2"
                        Stroke="#333333" 
                        HeightRequest="204" 
                        WidthRequest="204"
                        HorizontalOptions="Start"
                        VerticalOptions="Start"
                        Margin="0,20,0,0">
                    <!-- Отступ сверху -->

                    <Image Source="dotnet_bot.png"
                           Aspect="AspectFill"
                           HeightRequest="200"
                           WidthRequest="200"/>

                </Border>

                <!-- Поле с названием компании справа -->
                <VerticalStackLayout Grid.Column="1"
                         Grid.Row="0"
                         VerticalOptions="Start"
                         Spacing="10">

                    <Label Text="Название компании:"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="Black"/>

                    <Label Text="{Binding CompanyName}"
                           FontSize="20"
                           TextColor="#212121"/>

                    <Label Text="Контактная информация:"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="Black"/>

                    <Label Text="{Binding Contacts}"
                           FontSize="20"
                           TextColor="#212121"/>

                </VerticalStackLayout>

                <VerticalStackLayout Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Spacing="10">
                    <Label Text="Описание:"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="Black"/>

                    <Label Text="{Binding Description}"
                           FontSize="20"
                           TextColor="#212121"/>

                </VerticalStackLayout>
                
                <VerticalStackLayout Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2" Spacing="10">
                    <!-- Переключатель события/вакансии -->
                    <Grid ColumnDefinitions="*,*" 
                          ColumnSpacing="10">

                        <Border BackgroundColor="{Binding EventColor}"
                                Stroke="Transparent" 
                                StrokeThickness="0"
                                HeightRequest="50" 
                                HorizontalOptions="Fill" 
                                Padding="0">

                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10"/>
                            </Border.StrokeShape>

                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding EventTappedCommand}"/>
                            </Border.GestureRecognizers>

                            <Label Text="События" 
                                   FontSize="16" 
                                   HorizontalOptions="Center" 
                                   VerticalOptions="Center" 
                                   TextColor="Black"/>
                        </Border>

                        <Border Grid.Column="1" 
                                BackgroundColor="{Binding VacancyColor}"
                                Stroke="Transparent" 
                                StrokeThickness="0"
                                HeightRequest="50" 
                                HorizontalOptions="Fill" 
                                Padding="0">

                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10"/>
                            </Border.StrokeShape>

                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding VacancyTappedCommand}"/>
                            </Border.GestureRecognizers>

                            <Label Text="Вакансии" FontSize="16" 
                                   HorizontalOptions="Center" VerticalOptions="Center" TextColor="Black"/>
                        </Border>
                    </Grid>

                    <!-- CollectionView для событий -->
                    <CollectionView ItemsSource="{Binding DisplayedEvents}"
                                    IsVisible="{Binding IsVacancySelected, Converter={StaticResource InvertedBoolConverter}}"
                                    SelectionMode="Single"
                                    SelectionChangedCommand="{Binding EventSelectedCommand}"
                                    Margin="10,0">

                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <VerticalStackLayout Padding="0,5">
                                    <Border Padding="10" StrokeThickness="1" StrokeShape="RoundRectangle 10" Stroke="#e0e0e0">
                                        <VerticalStackLayout Spacing="5">
                                            <Label Text="{Binding Title}" FontSize="16" FontAttributes="Bold"/>
                                            <Label Text="{Binding FormattedDate}" FontSize="14" TextColor="Gray"/>
                                            <Label Text="{Binding EventLocation}" FontSize="14" TextColor="Gray"/>
                                            <Label Text="{Binding Description}" FontSize="14" LineBreakMode="TailTruncation" MaxLines="2"/>
                                        </VerticalStackLayout>
                                    </Border>
                                </VerticalStackLayout>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <!-- CollectionView для вакансий -->
                    <CollectionView ItemsSource="{Binding DisplayedVacancies}"
                                    IsVisible="{Binding IsVacancySelected}"
                                    SelectionMode="Single"
                                    SelectionChangedCommand="{Binding VacancySelectedCommand}"
                                    Margin="10,0">

                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <VerticalStackLayout Padding="0,5">
                                    <Border Padding="10" StrokeThickness="1" StrokeShape="RoundRectangle 10" Stroke="#e0e0e0">
                                        <VerticalStackLayout Spacing="5">
                                            <Label Text="{Binding Title}" FontSize="16" FontAttributes="Bold"/>
                                            <Label Text="{Binding SalaryRange}" FontSize="14" TextColor="Green" FontAttributes="Bold"/>
                                            <Label Text="{Binding WorkLocation}" FontSize="14" TextColor="Gray"/>
                                            
                                            <HorizontalStackLayout Spacing="5">
                                                <CollectionView ItemsSource="{Binding Tags}" SelectionMode="None">
                                                    
                                                    <CollectionView.ItemsLayout>
                                                        <LinearItemsLayout Orientation="Horizontal" ItemSpacing="5"/>
                                                    </CollectionView.ItemsLayout>
                                                    
                                                    <CollectionView.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border Padding="5,2" StrokeThickness="0" StrokeShape="RoundRectangle 10" BackgroundColor="#f0f0f0">
                                                                <Label Text="{Binding .}" FontSize="11"/>
                                                            </Border>
                                                        </DataTemplate>
                                                    </CollectionView.ItemTemplate>
                                                    
                                                </CollectionView>
                                            </HorizontalStackLayout>
                                        </VerticalStackLayout>
                                    </Border>
                                </VerticalStackLayout>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
                
            </Grid>

        </VerticalStackLayout>
        
    </ScrollView>
    
</ContentPage>