<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="EmploymentApp.Pages.EmployerPage"
             xmlns:models="clr-namespace:EmploymentApp.Models"
             Title="ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ð´Ð°Ñ‚ÐµÐ»Ñ">

    <ScrollView>
        <VerticalStackLayout>
            <Grid HeightRequest="40"
                  BackgroundColor="#9dfca8">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Label Text="Ð’Ð°ÐºÐ°Ð½ÑÐ¸Ð¸"
                        Grid.Column="0"
                        BackgroundColor="Transparent"
                        TextColor="Black"
                        FontSize="16"
                        VerticalOptions="Center"
                        HorizontalOptions="Center"/>

                <Label Text="Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ"
                       Grid.Column="1"
                       BackgroundColor="Transparent"
                       TextColor="Black"
                       FontSize="16"
                       VerticalOptions="Center"
                       HorizontalOptions="Start"/>

                <Label Text="Ð§Ð°Ñ‚"
                       Grid.Column="3"
                       BackgroundColor="Transparent"
                       TextColor="Black"
                       FontSize="16"
                       VerticalOptions="Center"
                       HorizontalOptions="End"/>

                <Label Text="ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ"
                       Grid.Column="4"
                       BackgroundColor="Transparent"
                       TextColor="Black"
                       FontSize="16"
                       VerticalOptions="Center"
                       HorizontalOptions="Center"/>

            </Grid>

            <ActivityIndicator IsRunning="{Binding IsLoading}" 
                               IsVisible="{Binding IsLoading}"
                               Color="#9dfca8"
                               Margin="0,20,0,0"/>

            <Grid RowDefinitions="*, Auto, Auto, Auto" 
                  ColumnDefinitions="Auto, *"
                  Padding="60,40,40,20" 
                  RowSpacing="30"
                  ColumnSpacing="40"
                  IsVisible="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}">

                <!-- ÐÐ²Ð°Ñ‚Ð°Ñ€ÐºÐ° -->
                <Border Grid.Column="0"
                        Grid.Row="0"
                        StrokeShape="RoundRectangle 100"
                        StrokeThickness="2"
                        Stroke="#333333" 
                        HeightRequest="204" 
                        WidthRequest="204"
                        HorizontalOptions="Start"
                        VerticalOptions="Start"
                        Margin="0,20,0,0">

                    <Image Source="dotnet_bot.png"
                           Aspect="AspectFill"
                           HeightRequest="200"
                           WidthRequest="200"/>

                </Border>

                <!-- ÐŸÐ¾Ð»Ðµ Ñ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÐµÐ¼ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸ ÑÐ¿Ñ€Ð°Ð²Ð° -->
                <VerticalStackLayout Grid.Column="1"
                         Grid.Row="0"
                         VerticalOptions="Start"
                         Spacing="10">

                    <Label Text="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸:"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="Black"/>

                    <Label Text="{Binding CompanyName}"
                           FontSize="20"
                           TextColor="#212121"/>

                    <Label Text="ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ:"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="Black"/>

                    <Label Text="{Binding CompanyPhone}"
                           FontSize="20"
                           TextColor="#212121"/>

                </VerticalStackLayout>

                <VerticalStackLayout Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2" Spacing="10">
                    <Label Text="ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ:"
                           FontSize="16"
                           FontAttributes="Bold"
                           TextColor="Black"/>

                    <Label Text="{Binding CompanyDescription}"
                           FontSize="20"
                           TextColor="#212121"/>

                </VerticalStackLayout>

                <VerticalStackLayout Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="2" Spacing="10">
                    <!-- ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ/Ð²Ð°ÐºÐ°Ð½ÑÐ¸Ð¸ -->
                    <Grid ColumnDefinitions="*,*" 
                          ColumnSpacing="10">

                        <Border BackgroundColor="{Binding EventColor}"
                                Stroke="Transparent" 
                                StrokeThickness="0"
                                HeightRequest="50" 
                                HorizontalOptions="Fill" 
                                Padding="0">

                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10"/>
                            </Border.StrokeShape>

                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding EventTappedCommand}"/>
                            </Border.GestureRecognizers>

                            <Label Text="Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ" 
                                   FontSize="16" 
                                   HorizontalOptions="Center" 
                                   VerticalOptions="Center" 
                                   TextColor="Black"/>
                        </Border>

                        <Border Grid.Column="1" 
                                BackgroundColor="{Binding VacancyColor}"
                                Stroke="Transparent" 
                                StrokeThickness="0"
                                HeightRequest="50" 
                                HorizontalOptions="Fill" 
                                Padding="0">

                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="10"/>
                            </Border.StrokeShape>

                            <Border.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding VacancyTappedCommand}"/>
                            </Border.GestureRecognizers>

                            <Label Text="Ð’Ð°ÐºÐ°Ð½ÑÐ¸Ð¸" FontSize="16" 
                                   HorizontalOptions="Center" VerticalOptions="Center" TextColor="Black"/>
                        </Border>
                    </Grid>

                    <!-- Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ñ (Ð²Ð¸Ð´Ð½Ñ‹ ÐºÐ¾Ð³Ð´Ð° IsVacancySelected = false) -->
                    <VerticalStackLayout IsVisible="{Binding IsVacancySelected, Converter={StaticResource InvertedBoolConverter}}"
                                        Spacing="10">

                        <!-- CollectionView Ð´Ð»Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ (Ð²Ð¸Ð´Ð½Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ) -->
                        <CollectionView ItemsSource="{Binding DisplayedEvents}"
                                        IsVisible="{Binding DisplayedEvents.Count, Converter={StaticResource NotEqualToConverter}, ConverterParameter=0}"
                                        SelectionMode="Single"
                                        SelectionChangedCommand="{Binding EventSelectedCommand}"
                                        Margin="10,0">

                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <VerticalStackLayout Padding="0,5">
                                        <Border Padding="10" StrokeThickness="1" StrokeShape="RoundRectangle 10" Stroke="#e0e0e0">
                                            <VerticalStackLayout Spacing="5">
                                                <Label Text="{Binding Title}" FontSize="16" FontAttributes="Bold"/>
                                                <Label Text="{Binding FormattedDate}" FontSize="14" TextColor="Gray"/>
                                                <Label Text="{Binding EventLocation}" FontSize="14" TextColor="Gray"/>
                                                <Label Text="{Binding Description}" FontSize="14" LineBreakMode="TailTruncation" MaxLines="2"/>
                                            </VerticalStackLayout>
                                        </Border>
                                    </VerticalStackLayout>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                        <!-- Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð³Ð´Ð° Ð½ÐµÑ‚ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ -->
                        <VerticalStackLayout Padding="20" Spacing="10"
                                           IsVisible="{Binding DisplayedEvents.Count, Converter={StaticResource EqualToConverter}, ConverterParameter=0}"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center">
                            <Label Text="ðŸŽª" FontSize="48" HorizontalOptions="Center"/>
                            <Label Text="ÐÐµÑ‚ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹" FontSize="18" FontAttributes="Bold" TextColor="Black" HorizontalOptions="Center"/>
                            <Label Text="Ð’Ñ‹ Ð¿Ð¾ÐºÐ° Ð½Ðµ ÑÐ¾Ð·Ð´Ð°Ð»Ð¸ Ð½Ð¸ Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ" FontSize="14" TextColor="Gray" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Ð’Ð°ÐºÐ°Ð½ÑÐ¸Ð¸ (Ð²Ð¸Ð´Ð½Ñ‹ ÐºÐ¾Ð³Ð´Ð° IsVacancySelected = true) -->
                    <VerticalStackLayout IsVisible="{Binding IsVacancySelected}"
                                        Spacing="10">

                        <!-- CollectionView Ð´Ð»Ñ Ð²Ð°ÐºÐ°Ð½ÑÐ¸Ð¹ (Ð²Ð¸Ð´Ð½Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð²Ð°ÐºÐ°Ð½ÑÐ¸Ð¸) -->
                        <CollectionView ItemsSource="{Binding DisplayedVacancies}"
                                        IsVisible="{Binding DisplayedVacancies.Count, Converter={StaticResource NotEqualToConverter}, ConverterParameter=0}"
                                        SelectionMode="Single"
                                        SelectionChangedCommand="{Binding VacancySelectedCommand}"
                                        Margin="10,0">

                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <VerticalStackLayout Padding="0,5">
                                        <Border Padding="10" StrokeThickness="1" StrokeShape="RoundRectangle 10" Stroke="#e0e0e0">
                                            <VerticalStackLayout Spacing="5">
                                                <Label Text="{Binding Title}" FontSize="16" FontAttributes="Bold"/>
                                                <Label Text="{Binding SalaryRange}" FontSize="14" TextColor="Green" FontAttributes="Bold"/>
                                                <Label Text="{Binding WorkLocation}" FontSize="14" TextColor="Gray"/>

                                                <HorizontalStackLayout Spacing="5">
                                                    <CollectionView ItemsSource="{Binding Tags}" SelectionMode="None">

                                                        <CollectionView.ItemsLayout>
                                                            <LinearItemsLayout Orientation="Horizontal" ItemSpacing="5"/>
                                                        </CollectionView.ItemsLayout>

                                                        <CollectionView.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Padding="5,2" StrokeThickness="0" StrokeShape="RoundRectangle 10" BackgroundColor="#f0f0f0">
                                                                    <Label Text="{Binding .}" FontSize="11"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </CollectionView.ItemTemplate>

                                                    </CollectionView>
                                                </HorizontalStackLayout>
                                            </VerticalStackLayout>
                                        </Border>
                                    </VerticalStackLayout>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                        <!-- Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð³Ð´Ð° Ð½ÐµÑ‚ Ð²Ð°ÐºÐ°Ð½ÑÐ¸Ð¹ -->
                        <VerticalStackLayout Padding="20" Spacing="10"
                                           IsVisible="{Binding DisplayedVacancies.Count, Converter={StaticResource EqualToConverter}, ConverterParameter=0}"
                                           HorizontalOptions="Center"
                                           VerticalOptions="Center">
                            <Label Text="ðŸ’¼" FontSize="48" HorizontalOptions="Center"/>
                            <Label Text="ÐÐµÑ‚ Ð²Ð°ÐºÐ°Ð½ÑÐ¸Ð¹" FontSize="18" FontAttributes="Bold" TextColor="Black" HorizontalOptions="Center"/>
                            <Label Text="Ð’Ñ‹ Ð¿Ð¾ÐºÐ° Ð½Ðµ ÑÐ¾Ð·Ð´Ð°Ð»Ð¸ Ð½Ð¸ Ð¾Ð´Ð½Ð¾Ð¹ Ð²Ð°ÐºÐ°Ð½ÑÐ¸Ð¸" FontSize="14" TextColor="Gray" HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                </VerticalStackLayout>

            </Grid>

        </VerticalStackLayout>

    </ScrollView>

</ContentPage>