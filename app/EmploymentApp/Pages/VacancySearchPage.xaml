<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="EmploymentApp.Pages.VacancySearchPage"
             Title="VacancySearchPage">

    <Grid RowDefinitions="Auto,*">

        <!-- Навигационный хедер -->
        <Grid Grid.Row="0" 
              HeightRequest="40"
              BackgroundColor="#9dfca8">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label Text="Вакансии"
                   Grid.Column="0"
                   BackgroundColor="Transparent"
                   TextColor="Black"
                   FontSize="16"
                   VerticalOptions="Center"
                   HorizontalOptions="Center"/>

            <Label Text="События"
                   Grid.Column="1"
                   BackgroundColor="Transparent"
                   TextColor="Black"
                   FontSize="16"
                   VerticalOptions="Center"
                   HorizontalOptions="Start"/>

            <Label Text="Чат"
                   Grid.Column="3"
                   BackgroundColor="Transparent"
                   TextColor="Black"
                   FontSize="16"
                   VerticalOptions="Center"
                   HorizontalOptions="End"/>

            <Label Text="Профиль"
                   Grid.Column="4"
                   BackgroundColor="Transparent"
                   TextColor="Black"
                   FontSize="16"
                   VerticalOptions="Center"
                   HorizontalOptions="Center">

                <Label.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding NavigateToProfileCommand}"/>
                </Label.GestureRecognizers>
                
            </Label>

        </Grid>

        <!-- Основное содержимое -->
        <Grid Grid.Row="1" ColumnDefinitions="250,*" RowDefinitions="*">

            <!-- Левая панель фильтров -->
            <Border Grid.Column="0" 
                    Grid.Row="0"
                    Padding="15"
                    BackgroundColor="#e8e8e8"
                    StrokeThickness="0">

                <VerticalStackLayout Spacing="15">
                    <Label Text="Фильтры" 
                           FontSize="16" 
                           FontAttributes="Bold"
                           TextColor="Black"/>

                    <!-- Здесь будут фильтры по тегам и поиск -->
                    <VerticalStackLayout Padding="10"
                                        BackgroundColor="#f5f5f5"
                                        Spacing="10">
                        <Label Text="Функционал фильтров в разработке..." 
                               FontSize="12"
                               TextColor="#999999"
                               HorizontalTextAlignment="Center"/>
                    </VerticalStackLayout>

                </VerticalStackLayout>
            </Border>

            <!-- Правая панель со списком вакансий -->
            <RefreshView Grid.Column="1" 
                         Grid.Row="0"
                         Command="{Binding LoadVacanciesCommand}"
                         IsRefreshing="{Binding IsLoading}">
                <ScrollView>
                    <VerticalStackLayout Padding="15" Spacing="5">

                        <!-- Сообщение об ошибке -->
                        <Label Text="{Binding ErrorMessage}"
                                   IsVisible="{Binding HasError}"
                                   TextColor="Red"
                                   FontSize="14"
                                   Padding="10"/>

                        <!-- Список вакансий -->
                        <CollectionView ItemsSource="{Binding Vacancies}"
                                            SelectionMode="None"
                                            SelectionChangedCommand="{Binding .}">

                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <VerticalStackLayout Padding="0,5">
                                        <Border Padding="10" 
                                                    StrokeThickness="1" 
                                                    StrokeShape="RoundRectangle 10" 
                                                    Stroke="#e0e0e0">

                                            <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">

                                                <!-- Основные данные -->
                                                <VerticalStackLayout Grid.Column="0" Spacing="8">
                                                    <Label Text="{Binding Title}" 
                                                               FontSize="16" 
                                                               FontAttributes="Bold"
                                                               TextColor="Black"/>

                                                    <Label Text="{Binding SalaryRange}" 
                                                               FontSize="14" 
                                                               TextColor="Green" 
                                                               FontAttributes="Bold"/>

                                                    <Label Text="{Binding WorkLocation}" 
                                                               FontSize="14" 
                                                               TextColor="Gray"/>

                                                    <!-- Теги -->
                                                    <CollectionView ItemsSource="{Binding Tags}" 
                                                                        SelectionMode="None" 
                                                                        HeightRequest="35">

                                                        <CollectionView.ItemsLayout>
                                                            <LinearItemsLayout Orientation="Horizontal" ItemSpacing="5"/>
                                                        </CollectionView.ItemsLayout>

                                                        <CollectionView.ItemTemplate>
                                                            <DataTemplate>
                                                                <Border Padding="5,2" 
                                                                            StrokeThickness="0" 
                                                                            StrokeShape="RoundRectangle 10" 
                                                                            BackgroundColor="#f0f0f0">
                                                                    <Label Text="{Binding .}" 
                                                                               FontSize="11"
                                                                               TextColor="Black"/>
                                                                </Border>
                                                            </DataTemplate>
                                                        </CollectionView.ItemTemplate>

                                                    </CollectionView>
                                                </VerticalStackLayout>

                                            </Grid>
                                        </Border>
                                    </VerticalStackLayout>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>

                        </CollectionView>

                    </VerticalStackLayout>
                </ScrollView>
            </RefreshView>

        </Grid>

    </Grid>

</ContentPage>